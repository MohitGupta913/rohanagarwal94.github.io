<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    
    <title>How to implement marker clustering using Google Maps API in a fragment | rohanagarwal94</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Google has provided an excellent documentation on marker clustering (Developers site) , but it still requires hours of hacking before an amateur like me implements it. For those who don’t know its use">
<meta property="og:type" content="article">
<meta property="og:title" content="How to implement marker clustering using Google Maps API in a fragment">
<meta property="og:url" content="https://rohanagarwal94.com/18/06/2016/marker-clustoring/index.html">
<meta property="og:site_name" content="rohanagarwal94">
<meta property="og:description" content="Google has provided an excellent documentation on marker clustering (Developers site) , but it still requires hours of hacking before an amateur like me implements it. For those who don’t know its use">
<meta property="og:image" content="https://rohanagarwal94.com/css/images/markers.png">
<meta property="og:updated_time" content="2016-08-08T17:50:55.446Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to implement marker clustering using Google Maps API in a fragment">
<meta name="twitter:description" content="Google has provided an excellent documentation on marker clustering (Developers site) , but it still requires hours of hacking before an amateur like me implements it. For those who don’t know its use">
    

    

    
        <link rel="icon" href="/css/images/Font_R.svg.png" />
    

    <link rel="stylesheet" href="/vendor/font-awesome/css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="/vendor/open-sans/styles.css" type="text/css">
    <link rel="stylesheet" href="/vendor/source-code-pro/styles.css" type="text/css">

    <link rel="stylesheet" href="/css/style.css" type="text/css">

    <script src="/vendor/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
    
    
        <link rel="stylesheet" href="/vendor/lightgallery/css/lightgallery.min.css" type="text/css">
    
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-75648858-1', 'auto');
ga('send', 'pageview');

</script>
    
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">rohanagarwal94</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="https://drive.google.com/file/d/0Bzq5O2CQ75-EZWFzT0xYa3FGU2M/view">CV</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/profile.jpg" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js" type="text/javascript"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="https://drive.google.com/file/d/0Bzq5O2CQ75-EZWFzT0xYa3FGU2M/view">CV</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/profile.jpg" />
            <h2 id="name">Rohan Agarwal</h2>
            <h3 id="title">Android Designer &amp; Developer</h3>
            <span id="location"><i class="fa fa-map-marker"></i>New Delhi, India</span>
            <a id="follow" target="_blank" href="https://twitter.com/rohanagarwal94">FOLLOW</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                4
                <span>posts</span>
            </div>
            <div class="article-info-block">
                10
                <span>tags</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="http://github.com/rohanagarwal94" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="http://facebook.com/rohan.agarwal.52" target="_blank" title="facebook" class=tooltip>
                            <i class="fa fa-facebook"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://in.linkedin.com/in/rohan-agarwal-b1685b116" target="_blank" title="linkedin" class=tooltip>
                            <i class="fa fa-linkedin"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://play.google.com/store/apps/developer?id=R%26R+Apps" target="_blank" title="android" class=tooltip>
                            <i class="fa fa-android"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://angel.co/rohan-agarwal-3" target="_blank" title="angellist" class=tooltip>
                            <i class="fa fa-angellist"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main"><article id="post-marker-clustoring" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
            How to implement marker clustering using Google Maps API in a fragment
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/18/06/2016/marker-clustoring/">
            <time datetime="2016-06-18T11:16:36.000Z" itemprop="datePublished">18-06-2016</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Google-Maps/">Google Maps</a>, <a class="tag-link" href="/tags/Google-Utils-Library/">Google Utils Library</a>, <a class="tag-link" href="/tags/JSON/">JSON</a>, <a class="tag-link" href="/tags/android/">android</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <img src="/css/images/markers.png" width="240" height="40">
<p>Google has provided an excellent documentation on marker clustering (<a href="https://developers.google.com/maps/documentation/android-api/utility/marker-clustering" target="_blank" rel="external">Developers site</a>) , but it still requires hours of hacking before an amateur like me implements it. For those who don’t know its use, clustering is used to represent large number of markers in an effective way.<br><a id="more"></a></p>
<p>This code gist is again part of my college app(<a href="https://play.google.com/store/apps/details?id=com.rnrapps.user.dtuguide&hl=en" target="_blank" rel="external">DtuGuide</a>). The Google Maps Android API utility library supports Android API level 9 and above. The animated re-clustering features are only available for Android API level 14 and above. When setting your project build target, make sure you use the latest Android API level. The following code implements clickable markers showing information regarding each marker and also the respective directions to reach a particular marker from the current location by implicitly calling Google Maps Application. I have implemented the concept in a fragment rather than an activity. The markers shown in the map above have been locally saved in the project itself in the form of a JSON file.<br>The following steps implement it-</p>
<h2 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h2><h3 id="Add-the-following-dependencies-to-your-app’s-Gradle-build-file-Do-update-the-libraries-if-a-newer-version-is-available"><a href="#Add-the-following-dependencies-to-your-app’s-Gradle-build-file-Do-update-the-libraries-if-a-newer-version-is-available" class="headerlink" title="Add the following dependencies to your app’s Gradle build file. Do update the libraries if a newer version is available."></a>Add the following dependencies to your app’s Gradle build file. Do update the libraries if a newer version is available.</h3><figure class="highlight gradle"><figcaption><span>build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'com.google.maps.android:android-maps-utils:0.4+'</span></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'com.google.android.gms:play-services-location:8.1.0'</span></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'com.google.android.gms:play-services-maps:8.1.0'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h2><h3 id="Locally-save-the-JSON-file-in-your-Assets-folder-which-contains-the-information-about-the-markers-In-my-case-apart-from-the-compulsory-latitude-and-longitude-I-have-stored-title-subtitle-floor-and-type-I-have-displayed-title-and-subtitle-in-my-information-dialog-on-clicking-the-marker-Each-object-of-the-array-represents-information-about-the-marker-Below-is-my-attached-JSON-file"><a href="#Locally-save-the-JSON-file-in-your-Assets-folder-which-contains-the-information-about-the-markers-In-my-case-apart-from-the-compulsory-latitude-and-longitude-I-have-stored-title-subtitle-floor-and-type-I-have-displayed-title-and-subtitle-in-my-information-dialog-on-clicking-the-marker-Each-object-of-the-array-represents-information-about-the-marker-Below-is-my-attached-JSON-file" class="headerlink" title="Locally save the JSON file in your Assets folder which contains the information about the markers . In my case, apart from the compulsory latitude and longitude, I have stored title, subtitle, floor and type. I have displayed title and subtitle in my information dialog on clicking the marker. Each object of the array represents information about the marker. Below is my attached JSON file."></a>Locally save the JSON file in your Assets folder which contains the information about the markers . In my case, apart from the compulsory latitude and longitude, I have stored title, subtitle, floor and type. I have displayed title and subtitle in my information dialog on clicking the marker. Each object of the array represents information about the marker. Below is my attached JSON file.</h3><figure class="highlight json"><figcaption><span>map.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">"<span class="attribute">map</span>":</span><br><span class="line"><span class="value">[</span><br><span class="line"></span><br><span class="line"> &#123;</span><br><span class="line">"<span class="attribute">title</span>": <span class="value"><span class="string">"OAT"</span></span>,</span><br><span class="line">"<span class="attribute">subtitle</span>": <span class="value"><span class="string">""</span></span>,</span><br><span class="line">"<span class="attribute">floor</span>": <span class="value"><span class="string">"Ground"</span></span>,</span><br><span class="line">"<span class="attribute">type</span>": <span class="value"><span class="string">""</span></span>,</span><br><span class="line">"<span class="attribute">latitude</span>": <span class="value"><span class="string">"28.75007207311156"</span></span>,</span><br><span class="line">"<span class="attribute">longitude</span>": <span class="value"><span class="string">"77.11772996932268"</span></span><br><span class="line"></span>&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">"<span class="attribute">title</span>": <span class="value"><span class="string">"SBGF1"</span></span>,</span><br><span class="line">"<span class="attribute">subtitle</span>": <span class="value"><span class="string">"Chemistry Lab"</span></span>,</span><br><span class="line">"<span class="attribute">floor</span>": <span class="value"><span class="string">"Ground"</span></span>,</span><br><span class="line">"<span class="attribute">type</span>": <span class="value"><span class="string">"Lab"</span></span>,</span><br><span class="line">"<span class="attribute">latitude</span>": <span class="value"><span class="string">"28.75136748222652"</span></span>,</span><br><span class="line">"<span class="attribute">longitude</span>": <span class="value"><span class="string">"77.1180622279644"</span></span><br><span class="line"></span>&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">"<span class="attribute">title</span>": <span class="value"><span class="string">"SBGF2"</span></span>,</span><br><span class="line">"<span class="attribute">subtitle</span>": <span class="value"><span class="string">"Processing Lab"</span></span>,</span><br><span class="line">"<span class="attribute">floor</span>": <span class="value"><span class="string">"Ground"</span></span>,</span><br><span class="line">"<span class="attribute">type</span>": <span class="value"><span class="string">""</span></span>,</span><br><span class="line">"<span class="attribute">latitude</span>": <span class="value"><span class="string">"28.75128988158836"</span></span>,</span><br><span class="line">"<span class="attribute">longitude</span>": <span class="value"><span class="string">"77.11803004145622"</span></span><br><span class="line"></span>&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">"<span class="attribute">title</span>": <span class="value"><span class="string">"SBGF3"</span></span>,</span><br><span class="line">"<span class="attribute">subtitle</span>": <span class="value"><span class="string">"Polymer Testing Lab"</span></span>,</span><br><span class="line">"<span class="attribute">floor</span>": <span class="value"><span class="string">"Ground"</span></span>,</span><br><span class="line">"<span class="attribute">type</span>": <span class="value"><span class="string">""</span></span>,</span><br><span class="line">"<span class="attribute">latitude</span>": <span class="value"><span class="string">"28.751279299678668"</span></span>,</span><br><span class="line">"<span class="attribute">longitude</span>": <span class="value"><span class="string">"77.1179549396038"</span></span><br><span class="line"></span>&#125;</span><br><span class="line">]</span><br><span class="line"></span>&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h2><h3 id="Create-a-layout-xml-file-for-your-fragment"><a href="#Create-a-layout-xml-file-for-your-fragment" class="headerlink" title="Create a layout xml file for your fragment."></a>Create a layout xml file for your fragment.</h3><figure class="highlight xml"><figcaption><span>mymap.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">FrameLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">fragment</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">"@+id/map"</span></span><br><span class="line">        <span class="attribute">android:name</span>=<span class="value">"com.google.android.gms.maps.SupportMapFragment"</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">AutoCompleteTextView</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"250dp"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"50dp"</span></span><br><span class="line">        <span class="attribute">android:padding</span>=<span class="value">"10dp"</span></span><br><span class="line">        <span class="attribute">android:hint</span>=<span class="value">"Search"</span></span><br><span class="line">        <span class="attribute">android:elevation</span>=<span class="value">"1dp"</span></span><br><span class="line">        <span class="attribute">android:layout_marginTop</span>=<span class="value">"5dp"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">"@+id/autoCompleteTextView"</span></span><br><span class="line">        <span class="attribute">android:layout_marginLeft</span>=<span class="value">"85dp"</span></span><br><span class="line">        <span class="attribute">android:layout_marginRight</span>=<span class="value">"85dp"</span></span><br><span class="line"></span><br><span class="line">        <span class="attribute">android:layout_above</span>=<span class="value">"@+id/button"</span></span><br><span class="line">        <span class="attribute">android:layout_centerHorizontal</span>=<span class="value">"true"</span></span><br><span class="line">        <span class="attribute">android:layout_gravity</span>=<span class="value">"center_horizontal|top"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Step-4"><a href="#Step-4" class="headerlink" title="Step 4"></a>Step 4</h2><h3 id="Create-a-Java-class-for-implementing-custom-cluster-item"><a href="#Create-a-Java-class-for-implementing-custom-cluster-item" class="headerlink" title="Create a Java class for implementing custom cluster item."></a>Create a Java class for implementing custom cluster item.</h3><figure class="highlight java"><figcaption><span>MyItem.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.maps.GoogleMap;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.maps.model.LatLng;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.maps.model.Marker;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.maps.model.MarkerOptions;</span><br><span class="line"><span class="keyword">import</span> com.google.maps.android.clustering.ClusterItem;</span><br><span class="line"><span class="keyword">import</span> com.google.maps.android.clustering.ClusterManager;</span><br><span class="line"><span class="keyword">import</span> com.google.maps.android.clustering.view.DefaultClusterRenderer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyItem</span> <span class="keyword">implements</span> <span class="title">ClusterItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LatLng mPosition;</span><br><span class="line">    <span class="keyword">private</span>  String title;</span><br><span class="line">    <span class="keyword">private</span> String subtitle;</span><br><span class="line">    <span class="keyword">private</span> String floor;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyItem</span><span class="params">(<span class="keyword">double</span> lat, <span class="keyword">double</span> lng,String stitle,String ssubtitle,String sfloor )</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        mPosition = <span class="keyword">new</span> LatLng(lat, lng);</span><br><span class="line">        title=stitle;</span><br><span class="line">        subtitle=ssubtitle;</span><br><span class="line">        floor=sfloor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getsubtitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> subtitle;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getfloor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> floor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LatLng <span class="title">getPosition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mPosition;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClusterRenderer</span> <span class="keyword">extends</span> <span class="title">DefaultClusterRenderer</span>&lt;<span class="title">MyItem</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyClusterRenderer</span><span class="params">(Context context, GoogleMap map,</span><br><span class="line">                             ClusterManager&lt;MyItem&gt; clusterManager)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, map, clusterManager);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onBeforeClusterItemRendered</span><span class="params">(MyItem item, MarkerOptions markerOptions)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onBeforeClusterItemRendered(item, markerOptions);</span><br><span class="line"></span><br><span class="line">        markerOptions.title(item.getTitle());</span><br><span class="line">        markerOptions.snippet(item.getsubtitle());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onClusterItemRendered</span><span class="params">(<span class="keyword">final</span> MyItem clusterItem, Marker marker)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onClusterItemRendered(clusterItem, marker);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Step-5"><a href="#Step-5" class="headerlink" title="Step 5"></a>Step 5</h2><h3 id="Create-the-corresponding-Java-classes-for-the-layout-file-created"><a href="#Create-the-corresponding-Java-classes-for-the-layout-file-created" class="headerlink" title="Create the corresponding Java classes for the layout file created."></a>Create the corresponding Java classes for the layout file created.</h3><figure class="highlight cs"><figcaption><span>getmarkerfromstring.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">getmarkerfromstring</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> lat;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> lng;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getLat</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> lat;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getLng</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> lng;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLat</span>(<span class="params"><span class="keyword">double</span> lat</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lat = lat;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLng</span>(<span class="params"><span class="keyword">double</span> lng</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lng = lng;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span>(<span class="params">String name</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight processing"><figcaption><span>MyMap.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.location.Location;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.support.v4.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.AdapterView;</span><br><span class="line"><span class="keyword">import</span> android.widget.ArrayAdapter;</span><br><span class="line"><span class="keyword">import</span> android.widget.AutoCompleteTextView;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.common.api.GoogleApiClient;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.location.LocationServices;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.maps.CameraUpdateFactory;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.maps.GoogleMap;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.maps.SupportMapFragment;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.maps.model.CameraPosition;</span><br><span class="line"><span class="keyword">import</span> com.google.android.gms.maps.model.LatLng;</span><br><span class="line"><span class="keyword">import</span> com.google.maps.android.clustering.Cluster;</span><br><span class="line"><span class="keyword">import</span> com.google.maps.android.clustering.ClusterManager;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.json.<span class="keyword">JSONArray</span>;</span><br><span class="line"><span class="keyword">import</span> org.json.JSONException;</span><br><span class="line"><span class="keyword">import</span> org.json.<span class="keyword">JSONObject</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">BufferedReader</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class MyMap extends Fragment &#123;</span><br><span class="line"></span><br><span class="line">    InputStream inputstream;</span><br><span class="line">    <span class="keyword">BufferedReader</span> reader;</span><br><span class="line">    <span class="keyword">String</span> title;</span><br><span class="line">    <span class="keyword">private</span> Location mCurrentLocation;</span><br><span class="line">    AutoCompleteTextView actv;</span><br><span class="line">    List&lt;MyItem&gt; items = <span class="keyword">new</span> ArrayList&lt;MyItem&gt;();</span><br><span class="line">    <span class="keyword">String</span> subtitle;</span><br><span class="line">    <span class="keyword">String</span> <span class="built_in">floor</span>;</span><br><span class="line">    <span class="keyword">String</span> type;</span><br><span class="line">    Double lat;</span><br><span class="line">    Double lng;</span><br><span class="line">    ArrayList&lt;getmarkerfromstring&gt; users=<span class="keyword">new</span> ArrayList&lt;getmarkerfromstring&gt;();</span><br><span class="line">    <span class="keyword">String</span>[] countries=<span class="keyword">new</span> <span class="keyword">String</span>[<span class="number">576</span>];</span><br><span class="line">    <span class="built_in">int</span> len;</span><br><span class="line">    <span class="built_in">int</span> arraylength;</span><br><span class="line">    ClusterManager&lt;MyItem&gt; mClusterManager;</span><br><span class="line">    <span class="keyword">JSONArray</span> jsonArray;</span><br><span class="line">    <span class="keyword">JSONObject</span> jsonObject;</span><br><span class="line">    <span class="keyword">String</span> m;</span><br><span class="line">    <span class="keyword">private</span> GoogleMap mMap;</span><br><span class="line">    <span class="keyword">private</span> GoogleApiClient</span><br><span class="line">            mGoogleApiClient;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) &#123;</span><br><span class="line">        mGoogleApiClient = <span class="keyword">new</span> GoogleApiClient.Builder(getActivity())</span><br><span class="line">                .addApi(LocationServices.API)</span><br><span class="line">                .build();</span><br><span class="line">                View v=inflater.inflate(R.layout.mymap, container, <span class="keyword">false</span>);</span><br><span class="line">        actv=(AutoCompleteTextView)v.findViewById(R.id.autoCompleteTextView);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> onActivityCreated(Bundle savedInstanceState) &#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">        setUpMapIfNeeded();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> onResume() &#123;</span><br><span class="line">        <span class="keyword">super</span>.onResume();</span><br><span class="line">        setUpMapIfNeeded();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> setUpMapIfNeeded() &#123;</span><br><span class="line">        <span class="keyword">if</span> (mMap == <span class="keyword">null</span>) &#123;</span><br><span class="line">            mMap = ((SupportMapFragment) getChildFragmentManager().findFragmentById(R.id.<span class="built_in">map</span>)).getMap();</span><br><span class="line"><span class="comment">//             Check if we were successful in obtaining the map.</span></span><br><span class="line">            <span class="keyword">if</span> (mMap != <span class="keyword">null</span>) &#123;</span><br><span class="line">                setUpMap();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> initCamera() &#123;</span><br><span class="line">        CameraPosition position = CameraPosition.builder()</span><br><span class="line">                .target(<span class="keyword">new</span> LatLng(YOUR_INITIALIZING_LATITUDE, YOUR_INITIALIZING_LONGITUDE))</span><br><span class="line">                .zoom(<span class="number">18</span>f)</span><br><span class="line">                .bearing(<span class="number">0.0</span>f)</span><br><span class="line">                .tilt(<span class="number">40</span>f)</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line"><span class="comment">//      Tilt is useful to give a 3D view of the map.</span></span><br><span class="line"></span><br><span class="line">        mMap.animateCamera(CameraUpdateFactory.newCameraPosition(position), <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//      Set Map type normal for easy loading of map.</span></span><br><span class="line"></span><br><span class="line">        mMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);</span><br><span class="line">        mMap.setTrafficEnabled(<span class="keyword">true</span>);</span><br><span class="line">        mMap.setMyLocationEnabled(<span class="keyword">true</span>);</span><br><span class="line">        mMap.getUiSettings().setZoomControlsEnabled(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> setUpMap() &#123;</span><br><span class="line">        mCurrentLocation =</span><br><span class="line">                LocationServices.FusedLocationApi.getLastLocation(mGoogleApiClient);</span><br><span class="line">        initCamera();</span><br><span class="line">        mClusterManager = <span class="keyword">new</span> ClusterManager&lt;MyItem&gt;(getActivity(), mMap);</span><br><span class="line">        mMap.setOnCameraChangeListener(mClusterManager);</span><br><span class="line">        mMap.setOnMarkerClickListener(mClusterManager);</span><br><span class="line"></span><br><span class="line">        mClusterManager</span><br><span class="line">                .setOnClusterClickListener(<span class="keyword">new</span> ClusterManager.OnClusterClickListener&lt;MyItem&gt;() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    <span class="keyword">public</span> <span class="built_in">boolean</span> onClusterClick(<span class="keyword">final</span> Cluster&lt;MyItem&gt; cluster) &#123;</span><br><span class="line">                        mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(</span><br><span class="line">                                        cluster.getPosition(), (<span class="built_in">float</span>) Math.<span class="built_in">floor</span>(mMap</span><br><span class="line">                                                .getCameraPosition().zoom + <span class="number">2</span>)), <span class="number">300</span>,</span><br><span class="line">                                <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//      I have used a local JSON file to fetch the marker information. You could also parse the</span></span><br><span class="line"><span class="comment">//      JSON file from the internet. I would suggest saving it locally, but if you really want to fetch it</span></span><br><span class="line"><span class="comment">//      from the internet, use Retrofit Http client developed by Square.</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            inputstream = getResources().getAssets().<span class="built_in">open</span>(<span class="string">"map.json"</span>);</span><br><span class="line">            reader = <span class="keyword">new</span> <span class="keyword">BufferedReader</span>(<span class="keyword">new</span> InputStreamReader(inputstream));</span><br><span class="line">            m = reader.toString();</span><br><span class="line">            StringBuilder total = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">            <span class="keyword">String</span> <span class="built_in">line</span>;</span><br><span class="line">            <span class="keyword">while</span> ((<span class="built_in">line</span> = reader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                total.<span class="built_in">append</span>(<span class="built_in">line</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            m = total.toString();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">            Toast.makeText(getActivity(), <span class="string">"fail"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//          JSON is parsed here.</span></span><br><span class="line"></span><br><span class="line">            jsonObject = <span class="keyword">new</span> <span class="keyword">JSONObject</span>(m);</span><br><span class="line">            jsonArray = jsonObject.optJSONArray(<span class="string">"map"</span>);</span><br><span class="line">            arraylength = jsonArray.length();</span><br><span class="line">            len = arraylength;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; arraylength; i++) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">JSONObject</span> jsonChildNode = jsonArray.getJSONObject(i);</span><br><span class="line">                title = jsonChildNode.optString(<span class="string">"title"</span>);</span><br><span class="line">                subtitle = jsonChildNode.optString(<span class="string">"subtitle"</span>);</span><br><span class="line">                <span class="built_in">floor</span> = jsonChildNode.optString(<span class="string">"floor"</span>);</span><br><span class="line">                type = jsonChildNode.optString(<span class="string">"type"</span>);</span><br><span class="line">                lat = jsonChildNode.optDouble(<span class="string">"latitude"</span>);</span><br><span class="line">                lng = jsonChildNode.optDouble(<span class="string">"longitude"</span>);</span><br><span class="line">                <span class="keyword">double</span> lat1=lat;</span><br><span class="line">                <span class="keyword">double</span> lng1=lng;</span><br><span class="line">                items.<span class="built_in">add</span>(<span class="keyword">new</span> MyItem(lat1,lng1,title,subtitle,<span class="built_in">floor</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//              I have implemented an autocompletetextview searching for the location on the map.</span></span><br><span class="line"><span class="comment">//              The search parameters include title and subtitle both.</span></span><br><span class="line"></span><br><span class="line">                countries[<span class="number">2</span>*i]=title;</span><br><span class="line">                countries[<span class="number">2</span>*i+<span class="number">1</span>]=subtitle;</span><br><span class="line">                getmarkerfromstring user = <span class="keyword">new</span> getmarkerfromstring();</span><br><span class="line">                user.setLat(lat1);</span><br><span class="line">                user.setLng(lng1);</span><br><span class="line">                user.setName(countries[i]);</span><br><span class="line">                users.<span class="built_in">add</span>(user);</span><br><span class="line">                getmarkerfromstring user2 = <span class="keyword">new</span> getmarkerfromstring();</span><br><span class="line">                user2.setLat(lat1);</span><br><span class="line">                user2.setLng(lng1);</span><br><span class="line">                user2.setName(countries[<span class="number">2</span>*i+<span class="number">1</span>]);</span><br><span class="line">                users.<span class="built_in">add</span>(user2);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            mClusterManager.addItems(items);</span><br><span class="line">            mClusterManager.setRenderer(<span class="keyword">new</span> MyClusterRenderer(getActivity(), mMap, mClusterManager));</span><br><span class="line">            mClusterManager.setOnClusterItemClickListener(<span class="keyword">new</span> ClusterManager.OnClusterItemClickListener&lt;MyItem&gt;() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                <span class="keyword">public</span> <span class="built_in">boolean</span> onClusterItemClick(MyItem myItem) &#123;</span><br><span class="line">                    Toast.makeText(getActivity(), myItem.getfloor() + <span class="string">" floor"</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//      The adapter to populate the autocompletetextview.</span></span><br><span class="line"></span><br><span class="line">        ArrayAdapter&lt;<span class="keyword">String</span>&gt; adapter= <span class="keyword">new</span> ArrayAdapter&lt;<span class="keyword">String</span>&gt;(getActivity(),</span><br><span class="line">                android.R.layout.simple_spinner_dropdown_item,countries);</span><br><span class="line">        actv.setAdapter(adapter);</span><br><span class="line"></span><br><span class="line">        actv.setOnItemClickListener(<span class="keyword">new</span> AdapterView.OnItemClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> onItemClick (AdapterView&lt;?&gt; parent, View view, <span class="built_in">int</span> position, <span class="keyword">long</span> id) &#123;</span><br><span class="line">                <span class="comment">//... your stuff</span></span><br><span class="line">                <span class="keyword">String</span> s=parent.getItemAtPosition(position).toString();</span><br><span class="line">                <span class="built_in">int</span> pos= Arrays.asList(countries).indexOf(s);</span><br><span class="line">                 LatLng lng=<span class="keyword">new</span> LatLng(users.<span class="built_in">get</span>(pos).getLat(),users.<span class="built_in">get</span>(pos).getLng());</span><br><span class="line">                        mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(lng,(<span class="built_in">float</span>)Math.<span class="built_in">floor</span>(mMap.getCameraPosition().zoom+<span class="number">8</span>)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Step-6"><a href="#Step-6" class="headerlink" title="Step 6"></a>Step 6</h2><h3 id="ABRA-KADABRA"><a href="#ABRA-KADABRA" class="headerlink" title="ABRA-KADABRA!!!"></a>ABRA-KADABRA!!!</h3><h2 id="NOTE-Take-care-of-YOUR-LATITUDE-HERE-YOUR-LONGITUDE-HERE"><a href="#NOTE-Take-care-of-YOUR-LATITUDE-HERE-YOUR-LONGITUDE-HERE" class="headerlink" title="NOTE: Take care of YOUR_LATITUDE_HERE,YOUR_LONGITUDE_HERE!!!"></a>NOTE: Take care of YOUR_LATITUDE_HERE,YOUR_LONGITUDE_HERE!!!</h2>
        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://rohanagarwal94.com/18/06/2016/marker-clustoring/" data-id="cisc2kzud0009jy3qwecyhy5k" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://rohanagarwal94.com/18/06/2016/marker-clustoring/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://rohanagarwal94.com/18/06/2016/marker-clustoring/">Comments</a>
    

        </footer>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/08/08/2016/pokemon/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Newer</strong>
            <div class="article-nav-title">
                
                    How to catch rare Pokemons in Pokemon Go
                
            </div>
        </a>
    
    
        <a href="/18/06/2016/Get-feeds-from-public-Facebook-page-without-using-Facebook-Graph-API/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Older</strong>
            <div class="article-nav-title">How to get feeds from public Facebook page without using Facebook Login in a Fragment</div>
        </a>
    
</nav>


    
</article>


    
    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>

</section>
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">recent</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/22/08/2016/bargainsoffpl/" class="thumbnail">
    
    
        <span style="background-image:url(/css/images/fpllogo.png)" alt="The top 10 bargains of Fantasy Premier League 2016/17" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/22/08/2016/bargainsoffpl/" class="title">The top 10 bargains of Fantasy Premier League 2016/17</a></p>
                            <p class="item-date"><time datetime="2016-08-21T19:32:27.000Z" itemprop="datePublished">22-08-2016</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/08/08/2016/pokemon/" class="thumbnail">
    
    
        <span style="background-image:url(/css/images/combine_images2.jpg)" alt="How to catch rare Pokemons in Pokemon Go" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/08/08/2016/pokemon/" class="title">How to catch rare Pokemons in Pokemon Go</a></p>
                            <p class="item-date"><time datetime="2016-08-08T06:16:27.000Z" itemprop="datePublished">08-08-2016</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/18/06/2016/marker-clustoring/" class="thumbnail">
    
    
        <span style="background-image:url(/css/images/markers.png)" alt="How to implement marker clustering using Google Maps API in a fragment" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/18/06/2016/marker-clustoring/" class="title">How to implement marker clustering using Google Maps API in a fragment</a></p>
                            <p class="item-date"><time datetime="2016-06-18T11:16:36.000Z" itemprop="datePublished">18-06-2016</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/18/06/2016/Get-feeds-from-public-Facebook-page-without-using-Facebook-Graph-API/" class="thumbnail">
    
    
        <span style="background-image:url(/css/images/pic.png)" alt="How to get feeds from public Facebook page without using Facebook Login in a Fragment" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/18/06/2016/Get-feeds-from-public-Facebook-page-without-using-Facebook-Graph-API/" class="title">How to get feeds from public Facebook page without using Facebook Login in a Fragment</a></p>
                            <p class="item-date"><time datetime="2016-06-18T11:16:36.000Z" itemprop="datePublished">18-06-2016</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    
        
<div id="twitter-feed" class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <a class="twitter-timeline" href="https://twitter.com/rohanagarwal94"
    data-widget-id="714493677247139840">Tweets by @rohanagarwal94</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?
      'http':'https';if(!d.getElementById(id)){js=d.createElement(s);
      js.id=id;js.src=p+"://platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </div>
</div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">2</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tags</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google-Maps/">Google Maps</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google-Utils-Library/">Google Utils Library</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fantasy-premier-league/">fantasy premier league</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/football/">football</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hack/">hack</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nocturnal/">nocturnal</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pokemon/">pokemon</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rare/">rare</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>

    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2016 Rohan Agarwal<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_config = function () {
        
            this.page.url = 'https://rohanagarwal94.com/18/06/2016/marker-clustoring/';
        
        this.page.identifier = 'marker-clustoring';
    };
    (function() { 
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'rohanagarwal94com' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>



    
        <script src="/vendor/lightgallery/js/lightgallery.min.js" type="text/javascript"></script>
        <script src="/vendor/lightgallery/js/lg-thumbnail.min.js" type="text/javascript"></script>
        <script src="/vendor/lightgallery/js/lg-pager.min.js" type="text/javascript"></script>
        <script src="/vendor/lightgallery/js/lg-autoplay.min.js" type="text/javascript"></script>
        <script src="/vendor/lightgallery/js/lg-fullscreen.min.js" type="text/javascript"></script>
        <script src="/vendor/lightgallery/js/lg-zoom.min.js" type="text/javascript"></script>
        <script src="/vendor/lightgallery/js/lg-hash.min.js" type="text/javascript"></script>
        <script src="/vendor/lightgallery/js/lg-share.min.js" type="text/javascript"></script>
        <script src="/vendor/lightgallery/js/lg-video.min.js" type="text/javascript"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js" type="text/javascript"></script>

    </div>
</body>
</html>